# ==============================================================================
# ğŸ“Œ Pin Memory â€” Test/Inference Policy
# ------------------------------------------------------------------------------
# Purpose:
#   â€¢ Control use of page-locked (pinned) host memory in **test/inference DataLoaders**.
#   â€¢ Ensures consistent configuration with `persistent_workers` in test loaders.
#   â€¢ Accelerates hostâ†’GPU transfers by avoiding OS paging overhead.
# ------------------------------------------------------------------------------
# When to Use
#   â€¢ ğŸš« Default: false â€” safe baseline for CI/leaderboard (minimal RAM, deterministic).
#   â€¢ âœ… True if:
#       â€“ Running on GPU (T4/A10/L4/A100) with large test batches.
#       â€“ Multi-pass inference (ensembles, MC dropout, calibration).
#   â€¢ âš ï¸ Ignored on CPU-only runs.
#
# Hydra Usage:
#   spectramind predict local/pin_memory@test_loader=enabled
#   spectramind predict local/pin_memory@test_loader=disabled
# ==============================================================================

pin_memory: false

notes: |
  Test loaders:
  â€¢ Disabled by default to reduce memory footprint and simplify CI/leaderboard runs.
  â€¢ Enables reproducibility and ensures compatibility with Kaggle's 9h runtime guardrails.
  â€¢ For GPU inference with many batches, enabling improves transfer throughput.
  â€¢ Always coordinate with `persistent_workers@test_loader`:
      â€“ If `persistent_workers=true`, also set `pin_memory=true` for maximal benefit.
      â€“ If `persistent_workers=false`, pinning alone may still help, but benefit is smaller.
  â€¢ Environment-aware best practices:
      â€“ Kaggle/CI leaderboard runs â†’ keep both `persistent_workers=false` and `pin_memory=false`.
      â€“ Local/HPC jobs â†’ enable both for long, repeated inference (ensembles, MC dropout).
  â€¢ Log both `pin_memory` and `persistent_workers` settings in v50_debug_log.md to
    preserve run-time auditability.
