name: "üõ°Ô∏è Security Report"
description: "Report a security vulnerability or suspicious activity affecting SpectraMind V50"
labels: ["security", "triage"]
assignees: []

body:
  - type: markdown
    attributes:
      value: |
        ## üõ°Ô∏è Security Report ‚Äî SpectraMind V50

        Thanks for helping keep the project and community safe.  
        **Do not** include secrets or exploit PoCs that could harm others. If this report contains sensitive details, please also email the security maintainers (add your team email here) for coordinated disclosure.

  - type: dropdown
    id: report_type
    attributes:
      label: "Report Type"
      description: "What are you reporting?"
      options:
        - "Vulnerability (code or config)"
        - "Supply-chain / dependency risk"
        - "Credential leak / secret exposure"
        - "CI/CD misconfiguration"
        - "Infra / container hardening issue"
        - "Suspicious behavior / compromise indicators"
        - "Other (describe below)"
      default: 0
    validations:
      required: true

  - type: input
    id: title
    attributes:
      label: "üìù Short Title"
      description: "Concise description of the issue."
      placeholder: "Example: Hardcoded token in submission workflow"
    validations:
      required: true

  - type: textarea
    id: description
    attributes:
      label: "üìÑ Description"
      description: "What did you find? Why is it a problem? Include links to files/lines if possible."
      placeholder: |
        - Affected component(s): CLI, CI workflow, Dockerfile, configs/*
        - Vulnerable behavior: ‚Ä¶
        - How it can be exploited / misused: ‚Ä¶
        - References/CWE: CWE-79, CWE-200, etc.
    validations:
      required: true

  - type: dropdown
    id: severity
    attributes:
      label: "Initial Severity (self-assessed)"
      options:
        - "Critical ‚Äî practical remote exploit / secret exfiltration"
        - "High ‚Äî privilege escalation or code execution with constraints"
        - "Medium ‚Äî info leak, DoS, or weak isolation"
        - "Low ‚Äî misconfig, best-practice gap, theoretical risk"
      default: 2

  - type: checkboxes
    id: impact
    attributes:
      label: "Potential Impact (check all that apply)"
      options:
        - label: "Secrets exposure (tokens, keys, passwords)"
        - label: "Unauthorized code execution"
        - label: "Privilege escalation / lateral movement"
        - label: "Data loss or corruption"
        - label: "Submission tampering / leaderboard integrity"
        - label: "Supply-chain compromise (deps, actions, containers)"
        - label: "Service disruption (CI, DVC remotes, storage)"
        - label: "Privacy / PII exposure"
        - label: "Other (describe in details)"

  - type: textarea
    id: repro
    attributes:
      label: "‚ôªÔ∏è Reproduction Steps (minimal & safe)"
      description: "Exact steps/commands to reproduce without causing harm. Prefer dry-run or redacted examples."
      placeholder: |
        1) git checkout <sha>
        2) spectramind <cmd> --dry-run ‚Ä¶
        3) Observe: ‚Ä¶
      render: shell

  - type: textarea
    id: scope
    attributes:
      label: "üß≠ Affected Scope"
      description: "Repos/branches, files, workflows, images, or environments impacted."
      placeholder: |
        - Branches: main, release/*
        - Workflows: .github/workflows/submission.yml
        - Images: ghcr.io/org/spectramind:v50-cuda12.1
        - Paths: src/‚Ä¶, configs/‚Ä¶, Dockerfile

  - type: textarea
    id: env
    attributes:
      label: "üñ•Ô∏è Environment"
      description: "Where observed (local, CI, Kaggle), OS/Kernel, container image digest, tool versions."
      placeholder: |
        - Repro: CI (GitHub Actions ubuntu-latest)
        - Docker: ghcr.io/org/spectramind:v50@sha256:‚Ä¶
        - Python 3.10, PyTorch 2.3, CUDA 12.1
        - Actions runner: 2025-08-20 build

  - type: input
    id: commit
    attributes:
      label: "üîí Code Reference"
      description: "Commit SHA(s) / tag(s) / PR(s) where the issue exists."
      placeholder: "e.g., 9a7b2f4, #2345"

  - type: textarea
    id: evidence
    attributes:
      label: "üßæ Evidence (redacted)"
      description: "Logs, screenshots, or snippets that prove the issue. **Redact secrets**."
      placeholder: |
        - npx trufflehog findings (redacted)
        - gh secret list vs workflow usage
        - docker scout / grype results

  - type: checkboxes
    id: exploitation
    attributes:
      label: "Has this been exploited?"
      options:
        - label: "No evidence of exploitation"
        - label: "Possibly (suspicious activity)"
        - label: "Confirmed (add details)"
        - label: "Unknown"

  - type: textarea
    id: indicators
    attributes:
      label: "üîé Indicators of Compromise (IoCs)"
      description: "Hashes, IPs, domains, actor behavior, timestamps, anomalous runs."
      placeholder: |
        - Unexpected workflow triggers from fork at 2025-08-24T11:20Z
        - New PAT usage from unknown IP (ASN ‚Ä¶)
        - Modified artifacts without matching CI run

  - type: textarea
    id: mitigation
    attributes:
      label: "üõ†Ô∏è Proposed Mitigation / Containment"
      description: "Short-term containment and long-term fix ideas (least-privilege, rotation, pinning, validation)."
      placeholder: |
        - Revoke/rotate BRANCH_PROTECT_PAT
        - Restrict gh-token permissions (contents:read, pull-requests:write only)
        - Pin GitHub Actions with SHA
        - Add CODEOWNERS + required reviews
        - Add secret scanning (trufflehog, Gitleaks) to PRs
        - Harden Dockerfile (USER non-root, read-only FS)

  - type: textarea
    id: disclosure
    attributes:
      label: "ü§ù Disclosure & Coordination"
      description: "Has anyone else been notified? Any embargo or coordinated disclosure timeline?"
      placeholder: |
        - Report sent to security@your-org.tld with PoC details
        - Request 90-day disclosure window

  - type: textarea
    id: acceptance
    attributes:
      label: "‚úÖ Acceptance Criteria"
      description: "Define ‚Äòfixed‚Äô (tests, scanners, policy changes, regression checks)."
      placeholder: |
        - Secrets rotated and verified unused
        - New CI job: secret scan + SBOM + vulnerability gate
        - Branch protection enforces required checks
        - Repro steps no longer succeed

  - type: checkboxes
    id: checklist
    attributes:
      label: "Pre-submit Checklist"
      options:
        - label: "No secrets or harmful payloads included"
        - label: "Repro steps are safe/dry-run"
        - label: "Provided commit/PR references"
        - label: "Included redacted evidence"
        - label: "Defined proposed mitigation and acceptance criteria"
